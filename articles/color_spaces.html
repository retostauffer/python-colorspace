<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Color Spaces: Classes and Utilities – colorspace</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo-wide.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../installation.html"> 
<span class="menu-text">Installation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../getstarted.html"> 
<span class="menu-text">Get started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../api.html"> 
<span class="menu-text">API</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../changelog.html"> 
<span class="menu-text">Changelog</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-articles" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Articles</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-articles">    
        <li>
    <a class="dropdown-item" href="../articles/color_spaces.html">
 <span class="dropdown-text">Color spaces</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/hcl_palettes.html">
 <span class="dropdown-text">HCL-Based Color Palettes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/palette_visualization.html">
 <span class="dropdown-text">Palette Visualization and Assessment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/choose_palette.html">
 <span class="dropdown-text">App for Choosing Palettes Interactively</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/cvd.html">
 <span class="dropdown-text">Color Vision Deficiency Emulation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/manipulation_utilities.html">
 <span class="dropdown-text">Color Manipulation and Utilities</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/approximations.html">
 <span class="dropdown-text">Approximate Colors from Other Packages</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/classes_and_methods.html">
 <span class="dropdown-text">Classes and Methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/endrainbow.html">
 <span class="dropdown-text">Somewhere over the Rainbow</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/retostauffer/python-colorspace/tree/main"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://pypi.org"> 
<span class="menu-text"><img src="../python-logo.svg" class="img-fluid"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Color Spaces: Classes and Utilities</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Function references</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.utils.adjust_transparency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">adjust_transparency</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.utils.check_hex_colors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">check_hex_colors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.choose_palette.choose_palette.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">choose_palette</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.colorlib.compare_colors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">compare_colors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.utils.contrast_ratio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">contrast_ratio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.cvd_emulator.cvd_emulator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">cvd_emulator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.utils.darken.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">darken</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.demos.demoplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">demoplot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.CVD.desaturate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">desaturate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.CVD.deutan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">deutan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.hcl_palettes.divergingx_palettes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">divergingx_palettes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.utils.extract_transparency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">extract_transparency</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.hcl_palettes.hcl_palettes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">hcl_palettes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.hclplot.hclplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">hclplot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.utils.lighten.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">lighten</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.utils.max_chroma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">max_chroma</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.utils.mixcolor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">mixcolor</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.CVD.protan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">protan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.specplot.specplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">specplot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.swatchplot.swatchplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">swatchplot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.CVD.tritan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tritan</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Class references</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.colorlib.CIELAB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CIELAB</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.colorlib.CIELUV.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CIELUV</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.colorlib.CIEXYZ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CIEXYZ</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.colorlib.HLS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HLS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.colorlib.HSV.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HSV</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.colorlib.RGB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RGB</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.colorlib.colorlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">colorlib</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.palettes.diverging_hcl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">diverging_hcl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.palettes.diverging_hsv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">diverging_hsv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.palettes.divergingx_hcl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">divergingx_hcl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.palettes.hclpalettes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">hclpalettes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.palettes.heat_hcl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">heat_hcl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.colorlib.hexcols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">hexcols</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.palettes.palette.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">palette</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.colorlib.polarLAB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">polarLAB</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.colorlib.polarLUV.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">polarLUV</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.palettes.qualitative_hcl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">qualitative_hcl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.palettes.rainbow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">rainbow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.palettes.rainbow_hcl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">rainbow_hcl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.colorlib.sRGB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">sRGB</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.palettes.sequential_hcl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">sequential_hcl</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../man/colorspace.palettes.terrain_hcl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">terrain_hcl</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#human-color-vision-and-the-hcl-color-model" id="toc-human-color-vision-and-the-hcl-color-model" class="nav-link" data-scroll-target="#human-color-vision-and-the-hcl-color-model">Human color vision and the HCL color model</a></li>
  <li><a href="#illustration-of-basic-colorspace-functionality" id="toc-illustration-of-basic-colorspace-functionality" class="nav-link" data-scroll-target="#illustration-of-basic-colorspace-functionality">Illustration of basic <em>colorspace</em> functionality</a></li>
  <li><a href="#color-library" id="toc-color-library" class="nav-link" data-scroll-target="#color-library">Color library</a></li>
  <li><a href="#matplotlib-color-maps" id="toc-matplotlib-color-maps" class="nav-link" data-scroll-target="#matplotlib-color-maps">Matplotlib color maps</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/retostauffer/python-colorspace/issues" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    <div class="quarto-margin-footer"><div class="margin-footer-item">
<p>Documentation built with Python <code>3.11.9</code> and quarto <code>1.5.53</code> on GitHub.</p>
</div></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Color Spaces: Classes and Utilities</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>At the core of the <em>colorspace</em> package are various utilities for computing with color spaces <span class="citation" data-cites="color:Wiki+Colorspace">Wikipedia (<a href="#ref-color:Wiki+Colorspace" role="doc-biblioref">2024c</a>)</span>, as the name conveys. Thus, the package helps to map various three-dimensional representations of color to each other <span class="citation" data-cites="color:Ihaka:2003">Ihaka (<a href="#ref-color:Ihaka:2003" role="doc-biblioref">2003</a>)</span>. A particularly important mapping is the one from the perceptually-based and device-independent color model HCL (Hue-Chroma-Luminance) to standard Red-Green-Blue (sRGB) which is the basis for color specifications in many systems based on the corresponding hex codes <span class="citation" data-cites="color:Wiki+Webcolors">Wikipedia (<a href="#ref-color:Wiki+Webcolors" role="doc-biblioref">2024g</a>)</span>, e.g., in HTML but also in Python. For completeness further standard color models are included as well in the package. Their connections are illustrated in the following graph:</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  X[CIEXYZ]
  PLUV((polarLUV&lt;br/&gt;HCL)) --- LUV[CIELUV] --- X
  PLAB((polarLAB)) --- LAB[CIELAB] --- X
  X ---|white point&lt;br&gt;= D65| RGB[RGB] ---|gamma&lt;br&gt;=2.4| sRGB[sRGB]
  RGB --- HSV
  sRGB --- HSV((HSV))
  sRGB --- hex{HEX}
  sRGB --- HLS((HLS))
  RGB --- HLS

  linkStyle 6 stroke-width:2px,fill:none,stroke:LightBlue;
  linkStyle 10 stroke-width:2px,fill:none,stroke:LightBlue;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>Color models that are (or try to be) perceptually-based are displayed with circles and models that are not are displayed with rectangles. The corresponding classes in <em>colorspace</em> are:</p>
<ul>
<li><a href="../man/colorspace.colorlib.RGB.html"><code>RGB</code></a> for the classic Red-Green-Blue color model, which mixes three primary colors with different intensities to obtain a spectrum of colors. The advantage of this color model is (or was) that it corresponded to how computer and TV screens generated colors, hence it was widely adopted and still is the basis for color specifications in many systems. For example, hex color codes are employed in HTML but also in Python. However, the RGB model also has some important drawbacks: It does not take into account the output device properties, it is not perceptually uniform (a unit step within RGB does not produce a constant perceptual change in color), and it is unintuitive for humans to specify colors (say brown or pink) in this space. <span class="citation" data-cites="color:Wiki+Colorspace">Wikipedia (<a href="#ref-color:Wiki+Colorspace" role="doc-biblioref">2024c</a>)</span></li>
<li><a href="../man/colorspace.colorlib.sRGB.html"><code>sRGB</code></a> addresses the issue of device dependency by adopting a so-called gamma correction. Therefore, the gamma-corrected standard RGB (sRGB), as opposed to the linearized RGB above, is a good model for specifying colors in software and for hardware. But it is still unintuitive for humans to work directly with this color space. Therefore, sRGB is a good place to end up in a color space manipulation but it is not a good place to start. <span class="citation" data-cites="color:Wiki+sRGB">Wikipedia (<a href="#ref-color:Wiki+sRGB" role="doc-biblioref">2024f</a>)</span></li>
<li><a href="../man/colorspace.colorlib.HSV.html"><code>HSV</code></a> is a simple transformation of the (s)RGB space that tries to capture the perceptual axes: hue (dominant wavelength, the type of color), saturation (colorfulness), and value (brightness, i.e., light vs.&nbsp;dark). Unfortunately, the three axes in the HSV model are confounded so that, e.g., brightness changes dramatically with hue. <span class="citation" data-cites="color:Wiki+Webcolors">Wikipedia (<a href="#ref-color:Wiki+Webcolors" role="doc-biblioref">2024g</a>)</span></li>
<li><a href="../man/colorspace.colorlib.HLS.html"><code>HSL</code></a> (Hue-Lightness-Saturation) is another transformation of (s)RGB that tries to capture the perceptual axes. It does a somewhat better job but the dimensions are still strongly confounded. <span class="citation" data-cites="color:Wiki+HSV">Wikipedia (<a href="#ref-color:Wiki+HSV" role="doc-biblioref">2024e</a>)</span></li>
<li><a href="../man/colorspace.colorlib.CIEXYZ.html"><code>CIEXYZ</code></a> was established by the CIE (Commission Internationale de l’Eclairage) based on experiments with human subjects. It provides a unique triplet of XYZ values, coding the standard observer’s perception of the color. It is device-independent but it is not perceptually uniform and the XYZ coordinates have no intuitive meaning. <span class="citation" data-cites="color:Wiki+CIEXYZ">Wikipedia (<a href="#ref-color:Wiki+CIEXYZ" role="doc-biblioref">2024a</a>)</span></li>
<li><a href="../man/colorspace.colorlib.CIELUV.html"><code>CIELUV</code></a> and <a href="../man/colorspace.colorlib.CIELAB.html"><code>CIELAB</code></a> were therefore proposed by the CIE as perceptually uniform color spaces where the former is typically preferred for emissive technologies (such as screens and monitors) whereas the latter is usually preferred when working with dyes and pigments. The L coordinate in both spaces has the same meaning and captures luminance (light-dark contrasts). Both the U and V coordinates as well as the A and B coordinates measure positions on red/green and yellow/blue axes, respectively, albeit in somewhat different ways. While this corresponds to how human color vision likely evolved (see the next section), these two color models still not correspond to perceptual axes that humans use to describe colors. <span class="citation" data-cites="color:Wiki+HSV">Wikipedia (<a href="#ref-color:Wiki+HSV" role="doc-biblioref">2024e</a>)</span>,<span class="citation" data-cites="color:Wiki+CIELAB">Wikipedia (<a href="#ref-color:Wiki+CIELAB" role="doc-biblioref">2024b</a>)</span></li>
<li><a href="../man/colorspace.colorlib.polarLUV.html"><code>polarLUV</code></a> (=HCL) and <a href="../man/colorspace.colorlib.polarLAB.html"><code>polarLAB</code></a> therefore take polar coordinates in the UV plane and AB plane, respectively. Specifically, the polar coordinates of the LUV model are known as the HCL (Hue-Chroma-Luminance) model (see <span class="citation" data-cites="color:Wiki+HCL">Wikipedia (<a href="#ref-color:Wiki+HCL" role="doc-biblioref">2024d</a>)</span>, which points out that the LAB-based polar coordinates are also sometimes referred to as HCL). The HCL model captures the human perceptual axes very well without confounding effects as in the HSV or HLS approaches (more details follow below).</li>
</ul>
</section>
<section id="human-color-vision-and-the-hcl-color-model" class="level2">
<h2 class="anchored" data-anchor-id="human-color-vision-and-the-hcl-color-model">Human color vision and the HCL color model</h2>
<p>It has been hypothesized that human color vision has evolved in three distinct stages:</p>
<ol type="1">
<li>Perception of light/dark contrasts (monochrome only).</li>
<li>Yellow/blue contrasts (usually associated with our notion of warm/cold colors).</li>
<li>Green/red contrasts (helpful for assessing the ripeness of fruit).</li>
</ol>
<p>See <span class="citation" data-cites="color:Kaiser+Boynton:1996">Kaiser and Boynton (<a href="#ref-color:Kaiser+Boynton:1996" role="doc-biblioref">1996</a>)</span>, <span class="citation" data-cites="color:Knoblauch:2002">Knoblauch (<a href="#ref-color:Knoblauch:2002" role="doc-biblioref">2002</a>)</span>, <span class="citation" data-cites="color:Ihaka:2003">Ihaka (<a href="#ref-color:Ihaka:2003" role="doc-biblioref">2003</a>)</span>, <span class="citation" data-cites="color:dichromat">Lumley (<a href="#ref-color:dichromat" role="doc-biblioref">2013</a>)</span> and/or <span class="citation" data-cites="color:Zeileis+Hornik+Murrell:2007">Zeileis, Hornik, and Murrell (<a href="#ref-color:Zeileis+Hornik+Murrell:2007" role="doc-biblioref">2007</a>)</span> for more details and references. Thus, colors can be described using a 3-dimensional space:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/human-axes.svg" class="img-fluid figure-img"></p>
<figcaption>Representation of the three axis of human color vision.</figcaption>
</figure>
</div>
<p>However, for describing colors in such a space, it is more natural for humans to employ polar coordinates in the color plane (yellow/blue vs.&nbsp;green/red, visualized by the dashed circle above) plus a third light/dark axis. Hence, color models that attempt to capture these perceptual axes are also called perceptually-based color spaces. As already argued above, the HCL model captures these dimensions very well, calling them: hue, chroma, and luminance.</p>
<p>The corresponding sRGB gamut, i.e., the HCL colors that can also be represented in sRGB, is visualized in the animation below <span class="citation" data-cites="color:Horvath+Lipka:2016">(<a href="#ref-color:Horvath+Lipka:2016" role="doc-biblioref">Horvath and Lipka 2016</a>)</span>.</p>
<ul>
<li><a href="https://upload.wikimedia.org/wikipedia/commons/transcoded/8/8d/SRGB_gamut_within_CIELCHuv_color_space_mesh.webm/SRGB_gamut_within_CIELCHuv_color_space_mesh.webm.480p.vp9.webm">Link to video (wikimedia.org)</a></li>
</ul>
<p>The shape of the HCL space is a distorted double cone which is seen best by looking at vertical slices, i.e., chroma-luminance planes for given hues. For example, the left panel below depicts the chroma-luminance plane for a certain blue (hue = 255). Along with luminance the colors change from dark to light. With increasing chroma the colors become more colorful, where the highest chroma is possible for intermediate luminance.</p>
<p>As some colors are relatively dark (e.g., blue and red assume their maximum chroma for relatively low luminances) while others are relatively light (e.g., yellow and green), horizontal slices of hue-chroma planes for given hue have somewhat irregular shapes. The right panel below shows such a hue-chroma plane for moderately light colors (luminance = 70). At that luminance, green and orange can become much more colorful compared to blue or red.</p>
<div>

</div>
<div id="4949859b" class="cell quarto-layout-panel" data-execution_count="1" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="color_spaces_files/figure-html/cell-2-output-1.png" class="img-fluid" width="858"></p>
</div>
</div>
</div>
</section>
<section id="illustration-of-basic-colorspace-functionality" class="level2">
<h2 class="anchored" data-anchor-id="illustration-of-basic-colorspace-functionality">Illustration of basic <em>colorspace</em> functionality</h2>
<p>As an example a vector of colors x can be specified in the HCL (or polar LUV) model:</p>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> colorspace.colorlib <span class="im">import</span> HCL</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> HCL(H <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">120</span>, <span class="dv">240</span>], C <span class="op">=</span> [<span class="fl">50.</span>] <span class="op">*</span> <span class="dv">3</span>, L <span class="op">=</span> [<span class="fl">70.</span>] <span class="op">*</span> <span class="dv">3</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="399fada8" class="cell quarto-layout-panel" data-execution_count="2" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<pre><code>polarLUV color object (3 colors)
           H       C       L
  1:    0.00   50.00   70.00
      120.00   50.00   70.00
      240.00   50.00   70.00</code></pre>
</div>
</div>
</div>
<p>The resulting three colors are pastel red (Hue = 0), green (Hue = 120), and blue (Hue = 240) with moderate chroma and luminance. For display in other systems an sRGB representation might be needed:</p>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x.to(<span class="st">"sRGB"</span>)    <span class="co"># Convert to sRGB coordinates</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="427b117d" class="cell quarto-layout-panel" data-execution_count="3" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<pre><code>sRGB color object (3 colors)
           R       G       B
  1:    0.89    0.59    0.65
        0.53    0.72    0.46
        0.49    0.69    0.87</code></pre>
</div>
</div>
</div>
<p>The displayed coordinates can also be extracted as numeric matrices by the calling the <code>.get()</code> method on a <code>colorobject</code>. As an example we convert the three colors to the <a href="../man/colorspace.colorlib.HSV.html"><code>HSV</code></a> color space and extract the saturation coordinate only by calling <a href="../man/colorspace.colorlib.HSV.get.html"><code>x.get("S")</code></a>.</p>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x.to(<span class="st">"HSV"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x.get(<span class="st">"S"</span>))     <span class="co"># Saturation dimension only</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="32731df3" class="cell quarto-layout-panel" data-execution_count="4" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<pre><code>HSV color object (3 colors)
           H       S       V
  1:  348.07    0.34    0.89
      104.61    0.36    0.72
      208.07    0.43    0.87
[0.34460077 0.36458245 0.4341857 ]</code></pre>
</div>
</div>
</div>
<p>For display in many systems hex color codes based on the sRGB coordinates can be created:</p>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x.colors())     <span class="co"># Automatically converts to hex</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="577a2b7e" class="cell quarto-layout-panel" data-execution_count="5" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<pre><code>['#E495A5', '#86B875', '#7DB0DD']</code></pre>
</div>
</div>
</div>
</section>
<section id="color-library" class="level2">
<h2 class="anchored" data-anchor-id="color-library">Color library</h2>
<p>The workhorse of these transformations is the <a href="../man/colorspace.colorlib.colorlib.html"><code>colorlib</code></a> class which allows to transform <code>colorobject</code> objects into each other.</p>
<ul>
<li>colorlib</li>
<li>colorobject</li>
</ul>
<p>The following classes (all inheriting from <code>colorobject</code>) are available to create colors in different color spaces: <a href="../man/colorspace.colorlib.polarLUV.html"><code>polarLUV</code></a> (HCL), <a href="../man/colorspace.colorlib.CIELUV.html"><code>CIELUV</code></a>, <a href="../man/colorspace.colorlib.polarLAB.html"><code>polarLAB</code></a>, <a href="../man/colorspace.colorlib.CIELAB.html"><code>CIELAB</code></a>, <a href="../man/colorspace.colorlib.CIEXYZ.html"><code>CIEXYZ</code></a>, <a href="../man/colorspace.colorlib.RGB.html"><code>RGB</code></a>, <a href="../man/colorspace.colorlib.sRGB.html"><code>sRGB</code></a>, <a href="../man/colorspace.colorlib.HSV.html"><code>HSV</code></a>, <a href="../man/colorspace.colorlib.HLS.html"><code>HLS</code></a>, <a href="../man/colorspace.colorlib.hexcols.html"><code>hexcols</code></a>, <a href="../man/colorspace.colorlib.colorlib.html"><code>colorlib</code></a>.</p>
<p>Colors can be transformed from and to (mostly all) color spaces using the <code>.to(&lt;name of color space&gt;)</code> method (see e.g., <a href="../man/colorspace.colorlib.hexcols.to.html"><code>hexcols.to</code></a>).</p>
</section>
<section id="matplotlib-color-maps" class="level2">
<h2 class="anchored" data-anchor-id="matplotlib-color-maps">Matplotlib color maps</h2>
<p>In addition many objects provided by the <em>colorspace</em> package allow to convert a series of colors (color palette) into a <code>matplotlib.colors.LinearSegmentedColormap</code> ‘cmap’ used by matplotlib. As an example using the object <code>x</code> from above:</p>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> colorspace <span class="im">import</span> palette</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> palette(x, <span class="st">"custom cmap palette"</span>).cmap()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cmap.N)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>cmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="052c4ed8" class="cell quarto-layout-panel" data-execution_count="6" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<pre><code>3</code></pre>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div style="vertical-align: middle;"><strong>custom cmap palette</strong> </div><div class="cmap"><img alt="custom cmap palette colormap" title="custom cmap palette" style="border: 1px solid #555;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAABACAYAAABsv8+/AAAAInRFWHRUaXRsZQBjdXN0b20gY21hcCBwYWxldHRlIGNvbG9ybWFwsHZduQAAACh0RVh0RGVzY3JpcHRpb24AY3VzdG9tIGNtYXAgcGFsZXR0ZSBjb2xvcm1hcEbBm9kAAAAwdEVYdEF1dGhvcgBNYXRwbG90bGliIHYzLjkuMCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZ/H/4w4AAAAydEVYdFNvZnR3YXJlAE1hdHBsb3RsaWIgdjMuOS4wLCBodHRwczovL21hdHBsb3RsaWIub3Jn31l8KQAAAUBJREFUeJzt1jERwkAAAMEkVjAXQxFAgR9E4OFLIiFU/GRuV8GVt36O13eBG3g+3rMT4NIY++wE+Mk2OwAA+D8DAABBBgAAggwAAAQZAAAIMgAAEGQAACDIAABAkAEAgCADAABBBgAAggwAAAQZAAAIMgAAEGQAACDIAABAkAEAgCADAABBBgAAggwAAAQZAAAIMgAAEGQAACDIAABAkAEAgCADAABBBgAAggwAAAQZAAAIMgAAEGQAACDIAABAkAEAgCADAABBBgAAggwAAAQZAAAIMgAAEGQAACDIAABAkAEAgCADAABBBgAAggwAAAQZAAAIMgAAEGQAACDIAABAkAEAgCADAABBBgAAggwAAAQZAAAIMgAAEGQAACDIAABAkAEAgCADAABBBgAAggwAAAQZAAAIMgAAEGQAACDoBPJ6B4d4/iGIAAAAAElFTkSuQmCC"></div><div style="vertical-align: middle; max-width: 514px; display: flex; justify-content: space-between;"><div style="float: left;"><div title="#e495a5ff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #e495a5ff;"></div> under</div><div style="margin: 0 auto; display: inline-block;">bad <div title="#00000000" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #00000000;"></div></div><div style="float: right;">over <div title="#7db0ddff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #7db0ddff;"></div></div>
</div>
</div>
</div>
<p>Please note that matplotlib performs linear interpolation in the sRGB color space between the colors specified. This allows us to draw more than 3 colors from the color map above. However, this may result in skewed color gradients!</p>
<p>The better way to go is to define/design your custom palette in the HCL color space using <a href="../man/colorspace.palettes.qualitative_hcl.html"><code>qualitative_hcl</code></a>, <a href="../man/colorspace.palettes.diverging_hcl.html"><code>diverging_hcl</code></a>, <a href="../man/colorspace.palettes.divergingx_hcl.html"><code>divergingx_hcl</code></a>, and <a href="../man/colorspace.palettes.sequential_hcl.html"><code>sequential_hcl</code></a> among others (see :ref:<code>HCL-Based Color Palettes &lt;article-hcl_palettes&gt;</code> for details).</p>
<p>These classes define color palettes via functions in the HCL color space and allow to draw large numbers of colors along the function space. The <code>.cmap()</code> will still return a <code>matplotlib.colors.LinearSegmentedColormap</code> but (by default) based on <code>n = 101</code> distinct colors which will require less linear interpolation.</p>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> colorspace <span class="im">import</span> diverging_hcl</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>pal  <span class="op">=</span> diverging_hcl(<span class="st">"Green-Orange"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> pal.cmap()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cmap.N)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>cmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="f43b9edc" class="cell quarto-layout-panel" data-execution_count="7" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<pre><code>101</code></pre>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div style="vertical-align: middle;"><strong>custom_hcl_cmap</strong> </div><div class="cmap"><img alt="custom_hcl_cmap colormap" title="custom_hcl_cmap" style="border: 1px solid #555;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAABACAYAAABsv8+/AAAAHnRFWHRUaXRsZQBjdXN0b21faGNsX2NtYXAgY29sb3JtYXCpyZflAAAAJHRFWHREZXNjcmlwdGlvbgBjdXN0b21faGNsX2NtYXAgY29sb3JtYXBjdX6KAAAAMHRFWHRBdXRob3IATWF0cGxvdGxpYiB2My45LjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmfx/+MOAAAAMnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHYzLjkuMCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZ99ZfCkAAAHnSURBVHic7dZNSgNBEIbhHicRwYXexvsvvI1Lwf+MB6gKdEwQ8XueZVHdk5lFeJf7x4dtNO6W6zK7bWY3Y19nS51dt7NdnY062zdn983Z/VjLbNfu1Vm3t1ua+9qzde/YfJ08v2veZZ38jWv7HS67t3Z70+/x82cc2z3rd5+1d/W3n3vCd10OX3W21dmY3Dvrvgv/lt/Z+6x7Z9452u/aPGf6vnq2+9bd3ux983tz79G+70l3fkzu1dl2aM5297XP6Pbem71mtr01e691bXtp9p6b+57qbIxR/0UAgH9PAABAIAEAAIEEAAAEEgAAEEgAAEAgAQAAgQQAAAQSAAAQSAAAQCABAACBBAAABBIAABBIAABAIAEAAIEEAAAEEgAAEEgAAEAgAQAAgQQAAAQSAAAQSAAAQCABAACBBAAABBIAABBIAABAIAEAAIEEAAAEEgAAEEgAAEAgAQAAgQQAAAQSAAAQSAAAQCABAACBBAAABBIAABBIAABAIAEAAIEEAAAEEgAAEEgAAEAgAQAAgQQAAAQSAAAQSAAAQCABAACBBAAABBIAABBIAABAIAEAAIEEAAAEEgAAEEgAAEAgAQAAgQQAAAQSAAAQSAAAQCABAACBBAAABBIAABBIAABAIAEAAIG+ARu3aQym9asOAAAAAElFTkSuQmCC"></div><div style="vertical-align: middle; max-width: 514px; display: flex; justify-content: space-between;"><div style="float: left;"><div title="#11c638ff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #11c638ff;"></div> under</div><div style="margin: 0 auto; display: inline-block;">bad <div title="#00000000" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #00000000;"></div></div><div style="float: right;">over <div title="#ef9708ff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #ef9708ff;"></div></div>
</div>
</div>
</div>
<p>A simple example using <code>matplotlib.pyplot.contourf</code> with a custom HCL based color palette (<code>sequential_hcl("Rocket").cmap()</code>):</p>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> ma</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> ticker, cm</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom color map</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> colorspace <span class="im">import</span> sequential_hcl</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> sequential_hcl(<span class="st">"Rocket"</span>).cmap()</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="fl">3.0</span>, <span class="fl">3.0</span>, N)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, N)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A low hump with a spike coming out.</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Needs to have z/colour axis on a log scale so we see both hump and spike.</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># linear scale only shows the spike.</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>Z1 <span class="op">=</span> np.exp(<span class="op">-</span>X<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> Y<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>Z2 <span class="op">=</span> np.exp(<span class="op">-</span>(X <span class="op">*</span> <span class="dv">10</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> (Y <span class="op">*</span> <span class="dv">10</span>)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> Z1 <span class="op">+</span> <span class="dv">50</span> <span class="op">*</span> Z2</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Put in some negative values (lower left corner) to cause trouble with logs:</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>z[:<span class="dv">5</span>, :<span class="dv">5</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co"># The following is not strictly essential, but it will eliminate</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co"># a warning.  Comment it out to see the warning.</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> ma.masked_where(z <span class="op">&lt;=</span> <span class="dv">0</span>, z)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatic selection of levels works; setting the</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co"># log locator tells contourf to use a log scale:</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Matlplotlib.contourf decides to draw 9 levels</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>cs <span class="op">=</span> ax.contourf(X, Y, z, locator<span class="op">=</span>ticker.LogLocator(), cmap<span class="op">=</span>cmap)</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="c0dfdf46" class="cell quarto-layout-panel" data-execution_count="8" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="color_spaces_files/figure-html/cell-9-output-1.png" class="img-fluid" width="586"></p>
</div>
</div>
</div>



</div></div></section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-color:Horvath+Lipka:2016" class="csl-entry" role="listitem">
Horvath, Michael, and Christoph Lipka. 2016. <span>“<span class="nocase">sRGB</span> Gamut Within <span>CIELCHuv</span> Color Space Isosurface.”</span> <a href="https://commons.wikimedia.org/wiki/File:SRGB_gamut_within_CIELCHuv_color_space_isosurface.png">https://commons.wikimedia.org/wiki/File:SRGB_gamut_within_CIELCHuv_color_space_isosurface.png</a>.
</div>
<div id="ref-color:Ihaka:2003" class="csl-entry" role="listitem">
Ihaka, Ross. 2003. <span>“Colour for Presentation Graphics.”</span> In <em>Proceedings of the 3rd International Workshop on Distributed Statistical Computing, Vienna, Austria</em>, edited by Kurt Hornik, Friedrich Leisch, and Achim Zeileis. <a href="http://www.ci.tuwien.ac.at/Conferences/DSC-2003/Proceedings/">http://www.ci.tuwien.ac.at/Conferences/DSC-2003/Proceedings/</a>.
</div>
<div id="ref-color:Kaiser+Boynton:1996" class="csl-entry" role="listitem">
Kaiser, Peter K., and Robert M. Boynton. 1996. <em>Human Color Vision</em>. 2nd ed. Washington, DC: Optical Society of America.
</div>
<div id="ref-color:Knoblauch:2002" class="csl-entry" role="listitem">
Knoblauch, Kenneth. 2002. <span>“Color Vision.”</span> In <em>Steven’s Handbook of Experimental Psychology – Sensation and Perception</em>, edited by Steven Yantis and Hal Pashler, Third, 1:41–75. New York: John Wiley &amp; Sons.
</div>
<div id="ref-color:dichromat" class="csl-entry" role="listitem">
Lumley, Thomas. 2013. <em><em>Dichromat</em>: Color Schemes for Dichromats</em>. <a href="https://CRAN.R-project.org/package=dichromat">https://CRAN.R-project.org/package=dichromat</a>.
</div>
<div id="ref-color:Wiki+CIEXYZ" class="csl-entry" role="listitem">
Wikipedia. 2024a. <span>“<span>CIE</span> 1931 Color Space — <span>W</span>ikipedia<span>,</span> the Free Encyclopedia.”</span> <a href="https://en.wikipedia.org/wiki/CIE_1931_color_space">https://en.wikipedia.org/wiki/CIE_1931_color_space</a>.
</div>
<div id="ref-color:Wiki+CIELAB" class="csl-entry" role="listitem">
———. 2024b. <span>“<span>CIELAB</span> Color Space — <span>W</span>ikipedia<span>,</span> the Free Encyclopedia.”</span> <a href="https://en.wikipedia.org/wiki/CIELAB_color_space">https://en.wikipedia.org/wiki/CIELAB_color_space</a>.
</div>
<div id="ref-color:Wiki+Colorspace" class="csl-entry" role="listitem">
———. 2024c. <span>“Color Space — <span>W</span>ikipedia<span>,</span> the Free Encyclopedia.”</span> <a href="https://en.wikipedia.org/wiki/Color_space">https://en.wikipedia.org/wiki/Color_space</a>.
</div>
<div id="ref-color:Wiki+HCL" class="csl-entry" role="listitem">
———. 2024d. <span>“<span>HCL</span> Color Space — <span>W</span>ikipedia<span>,</span> the Free Encyclopedia.”</span> <a href="https://en.wikipedia.org/wiki/HCL_color_space">https://en.wikipedia.org/wiki/HCL_color_space</a>.
</div>
<div id="ref-color:Wiki+HSV" class="csl-entry" role="listitem">
———. 2024e. <span>“<span>HSL</span> and <span>HSV</span> — <span>W</span>ikipedia<span>,</span> the Free Encyclopedia.”</span> <a href="https://en.wikipedia.org/wiki/HSL_and_HSV">https://en.wikipedia.org/wiki/HSL_and_HSV</a>.
</div>
<div id="ref-color:Wiki+sRGB" class="csl-entry" role="listitem">
———. 2024f. <span>“<span class="nocase">sRGB</span> — <span>W</span>ikipedia<span>,</span> the Free Encyclopedia.”</span> <a href="https://en.wikipedia.org/wiki/sRGB">https://en.wikipedia.org/wiki/sRGB</a>.
</div>
<div id="ref-color:Wiki+Webcolors" class="csl-entry" role="listitem">
———. 2024g. <span>“Web Colors — <span>W</span>ikipedia<span>,</span> the Free Encyclopedia.”</span> <a href="https://en.wikipedia.org/wiki/Web_colors">https://en.wikipedia.org/wiki/Web_colors</a>.
</div>
<div id="ref-color:Zeileis+Hornik+Murrell:2007" class="csl-entry" role="listitem">
Zeileis, Achim, Kurt Hornik, and Paul Murrell. 2007. <span>“Escaping <span>RGB</span>land: Selecting Colors for Statistical Graphics.”</span> Report 61. Department of Statistics; Mathematics, Wirtschaftsuniversität Wien, Research Report Series. <a href="http://epub.wu-wien.ac.at/">http://epub.wu-wien.ac.at/</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/retostauffer/python-colorspace/issues" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>